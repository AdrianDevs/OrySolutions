- id: "api:public"
  upstream:
    preserve_host: true
    url: http://web-api:8090
  match:
    url: http://<127.0.0.1|localhost>:8080/<(?!private).*>
    methods:
    - GET
    - POST
  authenticators:
    - handler: anonymous
  authorizer:
    handler: allow
  mutators:
  - handler: noop

- id: "api:protected"
  upstream:
    preserve_host: true
    url: http://web-api:8090
  match:
    url: http://<127.0.0.1|localhost>:8080/<private|private/.*>
    methods:
    - GET
    - POST
  authenticators:
    - handler: anonymous
  authorizer:
    handler: deny
  mutators:
  - handler: noop
  errors:
  - handler: json
    config:
      when:
      - request:
          header:
            accept: 
            - application/json
  - handler: redirect
    config:
      when:
      - request:
          header:
            accept:
            - text/*
            